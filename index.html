<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Nox</title>
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- index.html, inside <head> -->
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;700&display=swap" rel="stylesheet">


</head>


<body>
    <div id="container">
        <div id="sidebar">
            <!-- Toggle First -->
            <button id="toggleSidebar">«</button>

            <!-- Logo Immediately After -->
            <div id="sidebar-logo">
                <img src="icons/nox_newlogo.png" alt="Nox Logo">
            </div>

            <div id="sidebar-buttons">
                <!-- Nav Buttons Right Below Logo -->
                <button class="nav-btn selected" data-page="home">
                    <span class="icon">
                        <img src="icons\home.png" alt="Home" class="icon-img">
                    </span>
                    <span class="label">Dashboard</span>
                </button>
                <button class="nav-btn" data-page="malware-defense">
                    <span class="icon">
                        <img src="icons\shield.png" alt="Malware-defense" class="icon-img">
                    </span>
                    <span class="label">Malware Defense</span>
                </button>

                <button class="nav-btn" data-page="system-cleanup">
                    <span class="icon">
                        <img src="icons\cleanup.png" alt="System Cleanup" class="icon-img">
                    </span>
                    <span class="label">System Cleanup</span>
                </button>

                <button class="nav-btn" data-page="scanner">
                    <span class="icon">
                        <img src="icons\scan.png" alt="Scanner" class="icon-img">
                    </span>
                    <span class="label">Scanner</span>
                </button>

                <button class="nav-btn" data-page="system-health">
                    <span class="icon">
                        <img src="icons\health.png" alt="System Health" class="icon-img">
                    </span>
                    <span class="label">System Health</span>
                </button>

                <!-- Social links side-by-side -->
                <div class="social-links">
                    <a href="https://github.com/Cyb3rTyr/Nox" target="_blank">
                        <img src="icons/github.png" alt="GitHub" />
                    </a>
                </div>
            </div>
        </div>

        <div id="content">
            <div id="home" class="page active">
                <div class="dashboard-container">
                    <!-- LEFT COLUMN -->
                    <div class="left-col">
                        <!-- Top-left: Threats Blocked -->
                        <div class="threat-card">
                            <h2>Threats Blocked</h2>
                            <div class="chart-container">
                                <canvas id="threatsChart"></canvas>
                            </div>
                        </div>
                        <!-- Bottom-left: System Health & Updates -->
                        <div class="bottom-row">
                            <div class="health-card">
                                <h2>System Health</h2>
                                <div class="chart-container">
                                    <canvas id="healthChart"></canvas>
                                </div>
                            </div>
                            <div class="privacy-card">
                                <h2>Privacy Trackers</h2>
                                <div class="chart-container">
                                    <canvas id="privacyChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT COLUMN -->
                    <div class="right-col">
                        <!-- Top-right: Files Encrypted -->
                        <div class="files-card">
                            <h2>Files Encrypted</h2>
                            <div class="chart-container">
                                <canvas id="filesChart"></canvas>
                            </div>
                        </div>
                        <!-- Bottom-right: Privacy Trackers -->
                        <div class="bottom-row">
                            <div class="updates-card">
                                <h2>Updates Installed</h2>
                                <div class="chart-container">
                                    <canvas id="updatesChart"></canvas>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div id="malware-defense" class="page">
                <button class="info-btn" data-md="InfoBox\defender.md" title="More info">ℹ️</button>
                <h1>Malware Defense (Defender)</h1>
                <div class="controls">
                    <button id="md-update" class="action">Update Definitions</button>
                    <button id="md-quick" class="action">Quick Scan</button>
                    <button id="md-full" class="action">Full Scan</button>
                    <button id="md-folder-btn" class="action">Scan Folder…</button>
                    <input id="md-folder-input" type="file" webkitdirectory directory style="display:none" />
                    <button id="md-toggle-realtime" class="action">Turn Real-Time OFF</button>
                    <!-- loader next to buttons -->
                    <div id="md-loader" class="loader hidden"></div>
                </div>
                <!-- Empty-state placeholder -->
                <div id="md-empty" class="empty-state">
                    <img src="icons/scann_friend.png" alt="No scans yet" />
                </div>
                <div id="md-output" class="health-log"></div>
            </div>



            <div id="system-cleanup" class="page">
                <!-- ─── HEADER + INFO BUTTON ─────────────────────────── -->
                <div class="cleanup-header">
                    <h1>System Cleanup</h1>
                    <button class="info-btn" data-md="InfoBox\systemCleanUp.md" title="More info">ℹ️</button>
                </div>

                <!-- ─── YOUR EXISTING CONTROLS ───────────────────────── -->
                <div class="controls">
                    <button id="sc-scan" class="action">Scan</button>
                    <button id="sc-clean-all" class="action">Clean All Files</button>
                    <button id="sc-clean-old-updates" class="action">Clean Old Updates</button>
                    <button id="sc-clean-downloads" class="action">Clean Download Folder</button>
                    <button id="sc-clean-temp" class="action">Clean Temp Folder</button>
                </div>
            </div>


            <div id="scanner" class="page">
                <button class="info-btn" data-md="InfoBox\URL_scanner.md" title="More info">ℹ️</button>
                <div class="scanner-bar">
                    <input type="text" id="scanner-url-input" placeholder="Enter URL"
                        style="padding: 8px; width: 60%; margin-right: 8px; border-radius: 4px; border: 1px solid #ccc; font-size: 18px;" />
                    <button id="scanner-scan-btn"
                        style="padding: 8px 16px; background: #2196f3; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 18px;">
                        Scan
                    </button>
                </div>
            </div>


            <!-- System Health -->
            <div id="system-health" class="page">
                <h2>System Information</h2>
                <p><strong>CPU:</strong> <span id="cpuInfo"></span></p>
                <p><strong>RAM:</strong> <span id="ramInfo"></span></p>
                <p><strong>OS:</strong> <span id="osInfo"></span></p>
                <p><strong>Uptime:</strong> <span id="uptimeInfo"></span></p>
                <p id="healthWarning" style="color:gold;font-weight:bold"></p>

                <h2>Disk Space</h2>
                <div id="diskInfo"></div>

                <h2>Available Updates</h2>
                <button id="upgradeAllBtn">Upgrade All</button>
                <div id="updateList"></div>
                <div id="updateResult"></div>
            </div>



        </div>
        <!-- Modals and scripts here -->
        <script src="./pages/system_health.js"></script>
        <script src="renderer.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


        <div class="info-modal" id="info-modal">
            <div class="info-modal-content">
                <button class="close" title="Close">×</button>
                <div id="info-box-content"><!-- MD will go in here --></div>
            </div>
        </div>

        <div id="scanner-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div style="height:40px"></div>
                <div id="scanner-modal-body">
                    <pre>...scan result...</pre>
                </div>
            </div>
        </div>


        <!-- new-->
        <script>
            (async () => {
                const si = require('systeminformation');

                try {
                    // 1. Grab the CPU load object
                    const load = await si.currentLoad();
                    console.log('CPU load object:', load);

                    // 2. Use the correct property
                    const cpuPct = load.currentLoad.toFixed(1);

                    // 3. Decide status & color
                    let status, color;
                    if (cpuPct < 50) { status = 'Good'; color = 'green'; }
                    else if (cpuPct < 75) { status = 'Moderate'; color = 'orange'; }
                    else { status = 'High'; color = 'red'; }

                    // 4. Inject into the span#cpuInfo
                    document.getElementById('cpuInfo').innerHTML =
                        `${cpuPct}% <span style="color:${color};font-weight:bold;">(${status})</span>`;
                } catch (err) {
                    console.error('CPU load error:', err);
                    document.getElementById('cpuInfo').innerText = 'N/A';
                }

                // ——— RAM, OS & UPTIME ———
                try {
                    const mem = await si.mem();
                    const usedGB = (mem.used / 1e9).toFixed(1);
                    const totalGB = (mem.total / 1e9).toFixed(1);
                    const ramPct = ((mem.used / mem.total) * 100).toFixed(1);

                    let ramStatus, ramColor;
                    if (ramPct < 50) { ramStatus = 'Good'; ramColor = 'green'; }
                    else if (ramPct < 75) { ramStatus = 'Moderate'; ramColor = 'orange'; }
                    else { ramStatus = 'High'; ramColor = 'red'; }

                    document.getElementById('ramInfo').innerHTML =
                        `${usedGB} GB / ${totalGB} GB — ${ramPct}% ` +
                        `<span style="color:${ramColor};font-weight:bold">(${ramStatus})</span>`;
                } catch (err) {
                    console.error('RAM error:', err);
                    document.getElementById('ramInfo').innerText = 'N/A';
                }

                try {
                    const [osInfo, timeData] = await Promise.all([si.osInfo(), si.time()]);
                    const hrs = (timeData.uptime / 3600).toFixed(1);
                    document.getElementById('osInfo').innerText = `${osInfo.distro} (${osInfo.arch})`;
                    document.getElementById('uptimeInfo').innerText = `${hrs} hrs`;
                } catch (err) {
                    console.error('OS/uptime error:', err);
                    document.getElementById('osInfo').innerText = 'N/A';
                    document.getElementById('uptimeInfo').innerText = 'N/A';
                }
            })();
        </script>


        <!-- -->
</body>

</html>